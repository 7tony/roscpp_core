include(@INFRA_INSTALL_DIR@/parse_arguments.cmake)
include(@INFRA_INSTALL_DIR@/wg_python.cmake)
include(@INFRA_INSTALL_DIR@/debian-util.cmake)

macro(install_cmake_infrastructure PACKAGE_NAME)
  parse_arguments(PACKAGE "VERSION;INCLUDE_DIRS;LIBRARIES;CFG_EXTRAS;MSG_DIRS" "" ${ARGN})

  message("install_cmake_infrastructure ${PACKAGE_NAME} at version ${PACKAGE_VERSION} in @CMAKE_INSTALL_PREFIX@")
  set(pfx ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_FILES_DIRECTORY})
  set(PACKAGE_NAME ${PACKAGE_NAME})
  set(PACKAGE_VERSION ${PACKAGE_VERSION})
  set(PACKAGE_INCLUDE_DIRS ${PACKAGE_INCLUDE_DIRS})
  set(PACKAGE_LIBRARIES ${PACKAGE_LIBRARIES})
  set(PACKAGE_CFG_EXTRAS ${PACKAGE_CFG_EXTRAS})
  set(PACKAGE_CMAKE_CONFIG_FILES_DIR ${CMAKE_INSTALL_PREFIX}/share/cmake/${PACKAGE_NAME})
  set(PACKAGE_MSG_DIRS ${PACKAGE_MSG_DIRS})

  foreach(extra ${PACKAGE_CFG_EXTRAS})
    configure_file(${extra}.in
      ${extra}
      @ONLY
      )
  endforeach()

  configure_file(@INFRA_INSTALL_DIR@/pkg-config.cmake.in
    ${pfx}/${PACKAGE_NAME}-config.cmake
    @ONLY
    )
  configure_file(@INFRA_INSTALL_DIR@/pkg-config-version.cmake.in
    ${pfx}/${PACKAGE_NAME}-config-version.cmake
    @ONLY
    )
  install(FILES 
    ${pfx}/${PACKAGE_NAME}-config.cmake
    ${pfx}/${PACKAGE_NAME}-config-version.cmake
    ${PACKAGE_CFG_EXTRAS}
    DESTINATION share/cmake/${PACKAGE_NAME}
    )
  
endmacro()


